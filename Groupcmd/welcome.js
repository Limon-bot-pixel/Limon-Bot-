//========================================//
//         LIMON BOT PREMIUM WELCOME      //
//    FULL PP + GROUP + TIME + 500+ MSG   //
//========================================//

const moment = require("moment-timezone");
moment.tz.setDefault("Asia/Dhaka");

module.exports = {
    name: "welcome",
    alias: ["wlcm", "wlc"],
    desc: "Limon Full Welcome System",
    category: "group",
    
    run: async (client, m, { isAdmin, botAdmin, args }) => {

        //=========== ADMIN CHECK ===========//
        if (!m.isGroup) return m.reply("тЭМ ржПржЗ ржХржорж╛ржирзНржб рж╢рзБржзрзБ ржЧрзНрж░рзБржкрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржпрж╛ржмрзЗ!");
        if (!isAdmin && !botAdmin)
            return m.reply("тЫФ рж╢рзБржзрзБржорж╛рждрзНрж░ ржЧрзНрж░рзБржк ржПржбржорж┐ржи ржПржмржВ ржмржЯ ржПржбржорж┐ржи ржПржЗ ржХржорж╛ржирзНржб ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржи!");

        try {

            //=========== USER INFO ===========//
            const user = m.sender;
            let pp;
            try {
                pp = await client.profilePictureUrl(user, "image");
            } catch {
                pp = "https://i.ibb.co/gZ2y7Vj/default.jpg";
            }

            //=========== GROUP INFO ===========//
            const metadata = await client.groupMetadata(m.chat);
            const groupName = metadata.subject;
            const groupDesc = metadata.desc ? metadata.desc : "ржХрзЛржирзЛ ржбрж┐рж╕ржХрзНрж░рж┐ржкрж╢ржи рж╕рзЗржЯ ржХрж░рж╛ ржирзЗржЗред";
            const memberCount = metadata.participants.length;

            //=========== TIME ===========//
            const time = moment().format("h:mm A");
            const date = moment().format("DD/MM/YYYY");

            //=========== LIMON 500+ AUTO MESSAGES ===========//
            const baseMsg = [
                "ЁЯМ║ рж▓рж┐ржоржи ржмржЯ ржкрж░рж┐ржмрж╛рж░рзЗрж░ ржкржХрзНрж╖ ржерзЗржХрзЗ ржЖржирзНрждрж░рж┐ржХ рж╢рзБржнрзЗржЪрзНржЫрж╛!",
                "ЁЯТЪ рж╕рзНржмрж╛ржЧрждржо! рж▓рж┐ржоржи ржмржЯ ржЖржкржирж╛рж░ рж╕рж╛ржерзЗ ржЖржЫрзЗ рж╕рж░рзНржмржжрж╛!",
                "тЬи рж▓рж┐ржоржи рж╕рзНржЯрж╛ржЗрж▓рзЗ ржЖржкржирж╛ржХрзЗ ржЧрзНрж░рзБржкрзЗ ржмрж░ржг ржЬрж╛ржирж╛ржЗ!",
                "ЁЯФе ржЖржкржирж╛ржХрзЗ ржкрзЗржпрж╝рзЗ ржЧрзНрж░рзБржк ржЖрж░ржУ рж░ржЩрж┐ржи рж╣рж▓рзЛ!",
                "ЁЯОЙ рж╕рзНржмрж╛ржЧрждржо! рж▓рж┐ржоржи ржмржЯ ржЖржкржирж╛ржХрзЗ ржжрзЗржЦрзЗ ржЦрзБрж╢рж┐!",
                "ЁЯМ┐ рж╣рзНржпрж╛рж▓рзЛ ржирждрзБржи ржмржирзНржзрзБ! рж▓рж┐ржоржи ржмржЯ ржкрж░рж┐ржмрж╛рж░рзЗрж░ ржЕржВрж╢ рж╣ржпрж╝рзЗ ржпрж╛ржи!",
                "ЁЯМЯ рж▓рж┐ржоржи ржмржЯ ржмрж▓ржЫрзЗ: ржЖржкржирж╛рж░ ржЖржЧржоржирзЗ ржЧрзНрж░рзБржк ржЖрж▓рзЛржХрж┐ржд!",
                "ЁЯТл ржЖржкржирж╛ржХрзЗ рж▓рж┐ржоржи ржкрж░рж┐ржмрж╛рж░рзЗрж░ ржЕржирзНрждрж░рзЗ рж╕рзНржмрж╛ржЧрждржо!",
                "ЁЯМ╝ рж▓рж┐ржоржи ржмржЯ ржПрж░ ржкржХрзНрж╖ ржерзЗржХрзЗ ржЖржкржирж╛ржХрзЗ ржлрзБрж▓рзЗрж▓ рж╢рзБржнрзЗржЪрзНржЫрж╛!"
            ];

            const autoMessages = [];
            for (let i = 1; i <= 480; i++) {
                autoMessages.push(
                    `ЁЯТЪ рж▓рж┐ржоржи ржмржЯ рж╢рзБржнрзЗржЪрзНржЫрж╛ #${i} тАФ ржЖржорж╛ржжрзЗрж░ ржкрж░рж┐ржмрж╛рж░рзЗ рж╕рзНржмрж╛ржЧрждржо!`,
                    `ЁЯМ╕ ржирждрзБржи рж╕ржжрж╕рзНржп #${i}, рж▓рж┐ржоржи ржЖржкржирж╛ржХрзЗ рж╕рзНржмрж╛ржЧрждржо ржЬрж╛ржирж╛ржЪрзНржЫрзЗ!`,
                    `тЬи рж▓рж┐ржоржи ржлрзНржпрж╛ржорж┐рж▓рж┐ рж╕рзНржЯрж╛ржЗрж▓ #${i}: Enjoy your stay!`,
                    `ЁЯОЙ рж╕рзНржмрж╛ржЧрждржо! Limon Special Welcome #${i}`,
                    `ЁЯМ║ рж▓рж┐ржоржи ржмржЯ: ржирждрзБржи ржмржирзНржзрзБ #${i}, ржЧрзНрж░рзБржкрзЗ рж╕рзНржмрж╛ржЧрждржо!`
                );
            }

            const welcomeList = baseMsg.concat(autoMessages);
            const randomWelcome = welcomeList[Math.floor(Math.random() * welcomeList.length)];

            //=========== FINAL WELCOME TEXT ===========//
            const welcomeText = `
тХнтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтнУ  
тФВ ЁЯСЛ *ржирждрзБржи рж╕ржжрж╕рзНржп:* @${user.split("@")[0]}
тФВ ЁЯТЪ *Message:* ${randomWelcome}
тФВ ЁЯПб *ржЧрзНрж░рзБржк:* ${groupName}
тФВ ЁЯСе *ржорзЗржорзНржмрж╛рж░ рж╕ржВржЦрзНржпрж╛:* ${memberCount}
тФВ ЁЯУЕ *рждрж╛рж░рж┐ржЦ:* ${date}
тФВ тП░ *рж╕ржоржпрж╝:* ${time}
тФВ ЁЯУЭ *ржЧрзНрж░рзБржк ржбрж┐рж╕ржХрзНрж░рж┐ржкрж╢ржи:*  
тФВ ${groupDesc}
тФВ  
тФВ ЁЯФе *Powered by:* ЁЭРЛЁЭРвЁЭРжЁЭРиЁЭРз╪з┘К┌к┘А═м┘А┘А═д┘А┘Ас╖Ь┘А┘А═и┘А┘А═г┘А┘А═к┘А┘К_ф╣И 
тХ░тФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтнУ
`;

            //=========== SEND WELCOME + PP ===========//
            await client.sendMessage(m.chat, {
                image: { url: pp },
                caption: welcomeText,
                mentions: [user]
            });

        } catch (err) {
            console.log(err);
            m.reply("тЭМ Welcome system error!");
        }
    }
};